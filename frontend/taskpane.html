<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="utf-8" />
  <title>Assistente IA Jurídico (Multi‑cliente)</title>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <script src="./taskpane.js" defer></script>
  <style>
    /* Dark theme inspired by chat interfaces. */
    body {
      margin: 0;
      font-family: system-ui, sans-serif;
      display: flex;
      flex-direction: column;
      height: 100vh;
      background-color: #0f172a;
      /* slate‑900 */
      color: #f1f5f9;
      /* slate‑50 */
    }

    #chat {
      flex: 1;
      overflow-y: auto;
      padding: 1rem;
      box-sizing: border-box;
    }

    .message {
      max-width: 80%;
      margin-bottom: 0.75rem;
      padding: 0.5rem 0.75rem;
      border-radius: 0.5rem;
      line-height: 1.4;
    }

    .message.user {
      align-self: flex-end;
      background-color: #1e293b;
      /* slate‑800 */
    }

    .message.ai {
      align-self: flex-start;
      background-color: #334155;
      /* slate‑700 */
    }

    #inputBar {
      display: flex;
      padding: 0.5rem;
      background-color: #1e293b;
      /* slate‑800 */
      border-top: 1px solid #475569;
      /* slate‑600 */
    }

    #inputBar textarea {
      flex: 1;
      resize: none;
      min-height: 2.5rem;
      max-height: 8rem;
      padding: 0.5rem;
      background-color: #0f172a;
      /* slate‑900 */
      color: #f1f5f9;
      /* slate‑50 */
      border: 1px solid #475569;
      border-radius: 0.25rem;
    }

    #inputBar select,
    #inputBar button {
      margin-left: 0.5rem;
      padding: 0.5rem;
      background-color: #475569;
      /* slate‑600 */
      color: #f1f5f9;
      border: none;
      border-radius: 0.25rem;
      cursor: pointer;
    }

    #status {
      font-size: 0.75rem;
      color: #94a3b8;
      /* slate‑400 */
      ;
      margin-top: 0.25rem;
    }

    h3 {
      margin: 0;
      padding: 1rem;
      border-bottom: 1px solid #475569;
      font-size: 1.125rem;
      font-weight: 500;
      text-align: center;
      background-color: #0f172a;
    }
  </style>
</head>

<body>
  <h3>Assistente IA Jurídico</h3>
  <div id="chat"></div>
  <div id="inputBar">
    <textarea id="prompt" placeholder="Digite sua solicitação à IA..." rows="2"></textarea>
    <select id="mode">
      <option value="replace">Substituir seleção</option>
      <option value="after">Inserir abaixo da seleção</option>
      <option value="chat">Apenas Chat</option>
    </select>
    <button id="sendButton">Enviar</button>
  </div>
  <div id="status"></div>

  <!-- Configuration Section -->
  <div id="configSection"
    style="margin-top: 1rem; padding: 1rem; border-top: 1px solid #475569; background-color: #1e293b;">
    <h4 style="margin: 0 0 0.5rem 0; color: #f1f5f9;">Configurar Assistente</h4>

    <div style="display: flex; gap: 0.5rem; margin-bottom: 0.5rem;">
      <input id="apiKeyInput" type="password" placeholder="Sua API Key (Obrigatória)..."
        style="flex: 1; min-width: 0; background-color: #0f172a; color: white; border: 1px solid #475569; padding: 0.5rem;">
      <button id="saveKeyButton"
        style="padding: 0.5rem; background-color: #10b981; color: white; border: none; border-radius: 0.25rem; cursor: pointer;">Salvar</button>
    </div>

    <textarea id="roleDescription" placeholder="Ex: Advogado Especialista em Direito Digital..." rows="2"
      style="width: 100%; box-sizing: border-box; margin-bottom: 0.5rem; background-color: #0f172a; color: white; border: 1px solid #475569;"></textarea>
    <button id="configButton"
      style="width: 100%; padding: 0.5rem; background-color: #0ea5e9; color: white; border: none; border-radius: 0.25rem; cursor: pointer;">Otimizar
      e Salvar</button>
    <div id="configResult"
      style="margin-top: 0.5rem; font-size: 0.75rem; color: #94a3b8; max-height: 100px; overflow-y: auto;"></div>
  </div>

  <!-- Analysis Section -->
  <div style="margin: 1rem; padding-top: 1rem; border-top: 1px solid #475569;">
    <button id="analyzeButton"
      style="width: 100%; padding: 0.75rem; background-color: #8b5cf6; color: white; border: none; border-radius: 0.25rem; cursor: pointer; font-weight: bold;">
      Analisar Documento Completo
    </button>
  </div>

</body>

</html>